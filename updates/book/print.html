<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Thesis Updates</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">March 2022</li><li class="chapter-item expanded "><a href="march/wo_3-6-22.html"><strong aria-hidden="true">1.</strong> 3/6/2022</a></li><li class="chapter-item expanded "><a href="march/wo_3-23-22.html"><strong aria-hidden="true">2.</strong> 3/23/2022</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Thesis Updates</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This is a simple webpage/webbook put together for the purpose of keeping my advisor up to date on my research and thesis progress. It's also supposed to help me remember what I've done and hopefully why I've done things the way that I did. All of the pages are written in markdown for easy writing and the HTML &amp; CSS are all automatically generated using the mdbook program written in Rust.</p>
<p>I'm testing out using the mdbook features to write my update page because it will be easier to write out markdown files than the html directly. There's a button at the top left for toggling the table of contents and a paintbrush button for selecting the theme/colors of the page.</p>
<p>I can't do as much as if I wrote the pages directly, but it should do the job well enough. The program is meant to be used for writing web documentation and books (hence the name mdbook) but it should be fine for this purpose.</p>
<p>Below are just some tests of the functionality.</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Using an image as a link
<a href="./feb/2016_BDT_SR_lep_optCut.pdf"><img src="./feb/2016_BDT_SR_lep_optCut.png"></a></li>
<li><input disabled="" type="checkbox" checked=""/>
<span style="color:red">Changing the</span> <span style="color:blue">color of</span> <span style="color:green">the text</span>.</li>
<li><input disabled="" type="checkbox" checked=""/>
using \( \LaTeX \) in the page</li>
<li><input disabled="" type="checkbox" checked=""/>
using <sup>superscript</sup> and <sub>subscript</sub></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="362022"><a class="header" href="#362022">3/6/2022</a></h1>
<hr />
<p>I've been working on adding the three individual years together into a single set of plots to compare against the results of training on all three years combined from the beginning (which I refer to as &quot;Run 2&quot;). So far there's two issues. I can't save the counts for the backgrounds/signals in the individual year plots or add them together. There might be a way to work around this and pull the numbers from the legends and add them and then use the sums in a new legend, or loop over each bin in the histogram and add the counts. The latter option might be harder since it's a <span style="color:royalblue">THStack</span> not just a single histogram. The other issue is that the errors on the histogram's don't add because they're not histograms, they're <span style="color:royalblue;">TGraphAymmErrors</span>. I think I'll have to take the final histogram stack that gets saved and use that to create the new AsymmErrors (similar to how I create the errors in the first place).</p>
<p>The other thing I've been working on is expanding the uncertainties on the histograms. I've been looking at the analysis note and they don't have an overall reported uncertainty. For now I just added an overall systematic uncertainty of 10% in addition to the statistical uncertainties.</p>
<p>I spent a while debugging this because somehow just adding two lines that set the errors to include that extra 10% broke things. The plots displayed fine while the script was running, but when it saved as a pdf there was issues. Some plots saved just fine, other's were missing their axes or data, and some plots just didn't show up at all. Not sure what that was about, but I mostly fixed it. I had to change the errors histogram from a <span style="color: royalblue">TGraphAsymmErrors</span> to a <span style="color: royalblue">TGraphErrors</span> but it left me with the weird spike's at -1. If I turned the lower plot's errors into a <span style="color: royalblue">TGraphErrors</span> too the spike was like two bins wide. Also not sure what that was about.</p>
<p>Here's the result with the expanded uncertainty.</p>
<p><a href="march/./img/2016_test1_20-52.pdf">2016 Plot</a></p>
<p>Here's the result with the expanded uncertainty and the optimal BDT cut</p>
<p><a href="march/./img/2016_BDT_cut_5-35.pdf">2016 BDT cut</a></p>
<p>And the result with the optimal DNN_GPU cut</p>
<p><a href="march/./img/2016_DNN_cut_5-44.pdf">2016 DNN_GPU cut</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="3232022"><a class="header" href="#3232022">3/23/2022</a></h1>
<hr />
<h1 id="success"><a class="header" href="#success"><div style="text-align: center;">SUCCESS!</div></a></h1>
<h3 id="full-run-2"><a class="header" href="#full-run-2">Full run 2</a></h3>
<p>I went back to trying to add all three years together and I finally manged to get it to work. I think. </p>
<ul>
<li>I was originally trying to save the individual plots in a root file and then hadd them together, but that was never going to work because the plots had too many elements. Instead I just added the actual root files that the plots get made from and then made the plots from those summed files. I had to change how I was scaling the plots to make that work. Instead of using the &quot;Scale&quot; function, I just added a complicated cut to the plot that weighted each year and background group with the appropriate scale factor, and weighted the other events with 1.</li>
<li>So now I have two methods for analyzing the &quot;full run 2&quot; dataset. The &quot;run 2 summed&quot; method, and just the &quot;run 2&quot; method. The summed method is when I train each individual year separately and then add them together at the end to make plots. The non-summed (usually called &quot;full run 2,&quot; or &quot;non-summed&quot; method) method is when I start by adding all three years together and then train on one big dataset. Hopefully the &quot;summed&quot; vs &quot;non-summed&quot; makes at least some sense. Coming up with conventions is hard.</li>
<li>Comparing the two methods gives results that are about what I'd expect. Event counts that are somewhat close, but a little higher on the non-summed method because it has more input data it can select more likely-events that the individual years might have missed.</li>
<li>This new way of scaling the plots is also applied to both methods. I'm not sure on the implications of that though. The scale factors were determined on a year by year and background group by group basis. Since the full run 2 method doesn't look at each year individually, are those scale factors still valid?</li>
</ul>
<p>Here's the sets of plots to compare. The signal region cuts, and the optimal BDT cuts are both applied.</p>
<table><thead><tr><th><a href="march/img/3-23-22/Run2_Summed_BDT_20-14.pdf">Summed</a></th><th><a href="march/img/3-23-22/Run2_wv_SR_BDT_20-8.pdf">Non-summed</a></th></tr></thead><tbody>
</tbody></table>
<h3 id="retraining"><a class="header" href="#retraining">Retraining</a></h3>
<p>I wrote one large script to run each combination of the trainings and make the corresponding plots.</p>
<ul>
<li>I did two sets of training per year, one with only the events that pass the signal region cuts, and one with events that pass the much less restrictive wv_boosted cut. The SR cut is probably what I will focus on when it comes to the analysis, but the wv_boosted set are needed for making cutflows and generating the scale factors for the ttbar and W+jets backgrounds.</li>
<li>I can do more with the wv_boosted set of files, but my linux drive ran out of space so I had to move those files to an external drive. I'm sure I can probably run the plotting from files on an external drive, but I haven't tried it yet.</li>
<li>I also accidentally ran the training with 17 variables instead of 15, but it took 30 hours to finish (not to mention the time it errored out in the middle of a run, or the time I lost power halfway through another), so I'm tempted to just stick with this set and not retrain it all again.</li>
</ul>
<p>Here are the resulting plots</p>
<table><thead><tr><th>2016</th><th>2017</th><th>2018</th></tr></thead><tbody>
<tr><td><a href="march/img/3-23-22/2016_2016_wv_SR_14-59.pdf">SR cut</a></td><td><a href="march/img/3-23-22/2017_2017_wv_SR_21-32.pdf">SR cut</a></td><td><a href="march/img/3-23-22/2018_2018_wv_SR_2-22.pdf">SR cut</a></td></tr>
<tr><td><a href="march/img/3-23-22/2016_wv_SR_BDT_20-2.pdf">BDT cut</a></td><td><a href="march/img/3-23-22/2017_wv_SR_BDT_20-4.pdf">BDT cut</a></td><td><a href="march/img/3-23-22/2018_wv_SR_BDT_20-6.pdf">BDT cut</a></td></tr>
</tbody></table>
<p>There's so many combinations of years, types of plots, and cuts. We can hopefully figure out what the important combinations are and what's worth keeping/writing about.</p>
<h3 id="writing"><a class="header" href="#writing">Writing</a></h3>
<p>I've done a smidgen of writing, but on my commute home one day the fix for combining the years popped in my head and I've been pretty focused on that. I was working on some more of the background material, but I think it would be easier (based on how easy it is to ramble/write in these updates) to start focusing on writing about everything I've done, and then go back and fill in the background. </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
    </body>
</html>
